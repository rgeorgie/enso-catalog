{% extends "base.html" %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='print.css') }}?v=20260129">
{% endblock %}

{% block content %}
<div class="container">
  {% for rec in recs %}
    <div class="receipt card p-4 mb-4">
      <div class="d-flex justify-content-between align-items-start mb-3">
        <div>
          <h3 class="mb-1">Payment Receipt</h3>
          <div class="text-muted"># {{ rec.receipt_no or 'â€”' }}</div>
          <div class="text-muted">Date: {{ (rec.paid_at or rec.created_at).strftime('%Y-%m-%d %H:%M') }}</div>
        </div>
        <div class="text-end">
          <div><strong>Player:</strong> {{ rec.player.full_name() }}</div>
          <div><strong>ID:</strong> {{ rec.player.id }}</div>
        </div>
      </div>

      <hr/>

      {% if rec.kind.startswith('training') %}
        <p><strong>Category:</strong> Training fee</p>
        {% if rec.kind == 'training_month' %}
          <p><strong>Plan:</strong> Per month &nbsp;|&nbsp;
             <strong>Month:</strong> {{ "%04d-%02d"|format(rec.year or 0, rec.month or 0) }}</p>
        {% else %}
          <p><strong>Plan:</strong> Per session</p>
          <p><strong>Sessions:</strong> {{ rec.sessions_taken }}/{{ rec.sessions_paid }} taken</p>
        {% endif %}
      {% else %}
        <p><strong>Category:</strong> Event</p>
      {% endif %}

      <p class="mt-3">
        <strong>Amount:</strong> {{ rec.amount }} {{ rec.currency }}
        {% if rec.method %}&nbsp;|&nbsp;<strong>Method:</strong> {{ rec.method }}{% endif %}
      </p>

      {% if rec.note %}
        <p><strong>Notes:</strong> {{ rec.note }}</p>
      {% endif %}

    </div>
  {% endfor %}

  <div class="mt-3 no-print d-flex gap-2 justify-content-center">
    <button class="btn btn-primary" type="button" onclick="window.print()">Print</button>
    <a class="btn btn-outline-secondary" href="{{ request.referrer or url_for('list_players') }}">Back</a>
    <button class="btn btn-outline-danger" type="button" onclick="window.close()">Close</button>
  </div>
</div>

<!-- Print dialog auto-open removed -->
{% endblock %}
